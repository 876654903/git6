function repeatFn(e,s){"/list"===e?(s.setHeader("content-type","application/json"),s.end(JSON.stringify(list))):(s.setHeader("content-type","text/plain"),s.end("not font"))}var gulp=require("gulp"),url=require("url"),qs=require("qs"),webserver=require("gulp-webserver"),mincss=require("gulp-clean-css"),minjs=require("gulp-uglify"),minhtml=require("gulp-htmlmin");option={removeComments:!0,collapseWhitespace:!0,collapseBooleanAttributes:!0,removeEmptyAttributes:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,minifyJS:!0,minifyCSS:!0};var list=[{name:"百度",address:"北京市海淀区西北旺",info:"互联网|已上市|1000人",ps:"热招:前端工程师等23个职位",id:"1",img:"1.png"},{name:"百度",address:"北京市海淀区西北旺",info:"互联网|已上市|1000人",ps:"热招:前端工程师等23个职位",id:"1",img:"2.png"},{name:"百度",address:"北京市海淀区西北旺",info:"互联网|已上市|1000人",ps:"热招:前端工程师等23个职位",id:"1",img:"3.png"},{name:"百度",address:"北京市海淀区西北旺",info:"互联网|已上市|1000人",ps:"热招:前端工程师等23个职位",id:"1",img:"4.png"}];gulp.task("webserver",function(){gulp.src(".").pipe(webserver({port:"3000",middleware:function(e,s,i){var n=e.method,t=url.parse(e.url).pathname,r=null;if(s.setHeader("Access-Control-Allow-Origin","*"),"GET"===n)r=qs.parse(url.parse(e.url).query),repeatFn(t,s);else if("POST"===n){var p="";e.on("data",function(e){p+=e}),e.on("end",function(){r=-1!==p.indexOf("{")&&-1!==p.indexOf("}")?JSON.parse(p):qs.parse(p),repeatFn(t,s)})}else"OPTION"===n&&s.writeHead(200,{"content-type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-methods":"GET,POST,PUT,DELET","Access-Control-Allow-headers":"Accept,Origin,X-request-with,Content-type"})}}))}),gulp.task("mincss",function(){gulp.src("style.css").pipe(mincss()).pipe(gulp.dest("./mincss/"))}),gulp.task("minjs",function(){gulp.src("*.js").pipe(minjs()).pipe(gulp.dest("./minjs/"))}),gulp.task("minhtml",function(){gulp.src("*.html").pipe(minhtml(option)).pipe(gulp.dest("./minhtml/"))}),gulp.task("default",["webserver","mincss","minhtml","minjs"]);